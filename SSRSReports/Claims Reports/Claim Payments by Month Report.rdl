<?xml version="1.0" encoding="utf-8"?>
<Report MustUnderstand="df" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:df="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition/defaultfontfamily">
  <df:DefaultFontFamily>Segoe UI</df:DefaultFontFamily>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="SharedDS">
      <DataSourceReference>/SharedDS</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>14065810-c363-43b2-8e94-9587174e9ba9</rd:DataSourceID>
    </DataSource>
    <DataSource Name="SharedLocalDS">
      <DataSourceReference>/SharedLocalDS</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>3798a578-1448-43d5-b79d-83fea330688c</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>SharedLocalDS</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@RptYear">
            <Value>=Parameters!RptYear.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@AsOfDate">
            <Value>=Parameters!AsOfDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@LOB">
            <Value>=Parameters!LOB.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>--declare @RptYear			char(4);
--declare	@LOB				varchar(2000);
--declare @AsOfDate			datetime;

declare @RptPYYear			char(4);
declare @RptBeginDate1		datetime;
declare @RptEndDate1		datetime;
declare @RptBeginDate2		datetime;
declare @RptEndDate2		datetime;
declare @RptBeginDate3		datetime;
declare @RptEndDate3		datetime;
declare @RptBeginDate4		datetime;
declare @RptEndDate4		datetime;
declare @RptBeginDate5		datetime;
declare @RptEndDate5		datetime;
declare @RptBeginDate6		datetime;
declare @RptEndDate6		datetime;
declare @RptBeginDate7		datetime;
declare @RptEndDate7		datetime;
declare @RptBeginDate8		datetime;
declare @RptEndDate8		datetime;
declare @RptBeginDate9		datetime;
declare @RptEndDate9		datetime;
declare @RptBeginDate10		datetime;
declare @RptEndDate10		datetime;
declare @RptBeginDate11		datetime;
declare @RptEndDate11		datetime;
declare @RptBeginDate12		datetime;
declare @RptEndDate12		datetime;
declare @RptPYBeginDate1	datetime;
declare @RptPYEndDate1		datetime;
declare @RptPYBeginDate2	datetime;
declare @RptPYEndDate2		datetime;
declare @RptPYBeginDate3	datetime;
declare @RptPYEndDate3		datetime;
declare @RptPYBeginDate4	datetime;
declare @RptPYEndDate4		datetime;
declare @RptPYBeginDate5	datetime;
declare @RptPYEndDate5		datetime;
declare @RptPYBeginDate6	datetime;
declare @RptPYEndDate6		datetime;
declare @RptPYBeginDate7	datetime;
declare @RptPYEndDate7		datetime;
declare @RptPYBeginDate8	datetime;
declare @RptPYEndDate8		datetime;
declare @RptPYBeginDate9	datetime;
declare @RptPYEndDate9		datetime;
declare @RptPYBeginDate10	datetime;
declare @RptPYEndDate10		datetime;
declare @RptPYBeginDate11	datetime;
declare @RptPYEndDate11		datetime;
declare @RptPYBeginDate12	datetime;
declare @RptPYEndDate12		datetime;

begin

--set @RptYear	= '2022'
--set @LOB = 'GL'
--set @AsOfDate = '5/31/2022'
set @RptPYYear	= @RptYear - 1

set @RptBeginDate1 = '01/01/' + @RptYear
set @RptEndDate1 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate1))

set @RptBeginDate2 = '02/01/' + @RptYear
set @RptEndDate2 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate2))

set @RptBeginDate3 = '03/01/' + @RptYear
set @RptEndDate3 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate3))

set @RptBeginDate4 = '04/01/' + @RptYear
set @RptEndDate4 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate4))

set @RptBeginDate5 = '05/01/' + @RptYear
set @RptEndDate5 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate5))

set @RptBeginDate6 = '06/01/' + @RptYear
set @RptEndDate6 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate6))

set @RptBeginDate7 = '07/01/' + @RptYear
set @RptEndDate7 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate7))

set @RptBeginDate8 = '08/01/' + @RptYear
set @RptEndDate8 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate8))

set @RptBeginDate9 = '09/01/' + @RptYear
set @RptEndDate9 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate9))

set @RptBeginDate10 = '10/01/' + @RptYear
set @RptEndDate10 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate10))

set @RptBeginDate11 = '11/01/' + @RptYear
set @RptEndDate11 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate11))

set @RptBeginDate12 = '12/01/' + @RptYear
set @RptEndDate12 = dateadd(d, -1, dateadd(m, 1, @RptBeginDate12))




set @RptPYBeginDate1 = '01/01/' + @RptPYYear
set @RptPYEndDate1 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate1))

set @RptPYBeginDate2 = '02/01/' + @RptPYYear
set @RptPYEndDate2 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate2))

set @RptPYBeginDate3 = '03/01/' + @RptPYYear
set @RptPYEndDate3 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate3))

set @RptPYBeginDate4 = '04/01/' + @RptPYYear
set @RptPYEndDate4 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate4))

set @RptPYBeginDate5 = '05/01/' + @RptPYYear
set @RptPYEndDate5 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate5))

set @RptPYBeginDate6 = '06/01/' + @RptPYYear
set @RptPYEndDate6 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate6))

set @RptPYBeginDate7 = '07/01/' + @RptPYYear
set @RptPYEndDate7 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate7))

set @RptPYBeginDate8 = '08/01/' + @RptPYYear
set @RptPYEndDate8 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate8))

set @RptPYBeginDate9 = '09/01/' + @RptPYYear
set @RptPYEndDate9 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate9))

set @RptPYBeginDate10 = '10/01/' + @RptPYYear
set @RptPYEndDate10 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate10))

set @RptPYBeginDate11 = '11/01/' + @RptPYYear
set @RptPYEndDate11 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate11))

set @RptPYBeginDate12 = '12/01/' + @RptPYYear
set @RptPYEndDate12 = dateadd(d, -1, dateadd(m, 1, @RptPYBeginDate12))




select aaaaaa.RptYear,
       aaaaaa.MonthNum,
       aaaaaa.Month,
       aaaaaa.CategoryOrder,
	   aaaaaa.CategoryType,
       sum(Amount) Amount
from (


-- Month 1


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate1) MonthNum,
	   datename(Month, @RptBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id 

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate1) 
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate1) MonthNum,
	   datename(Month, @RptBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate1)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate1) MonthNum,
	   datename(Month, @RptBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate1)
group by aaaaa.lob_id


union all


-- Month 2


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate2) MonthNum,
	   datename(Month, @RptBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate2)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate2) MonthNum,
	   datename(Month, @RptBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate2)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate2) MonthNum,
	   datename(Month, @RptBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate2)
group by aaaaa.lob_id


union all


-- Month 3


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate3) MonthNum,
	   datename(Month, @RptBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate3)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate3) MonthNum,
	   datename(Month, @RptBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate3)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate3) MonthNum,
	   datename(Month, @RptBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate3)
group by aaaaa.lob_id


union all


-- Month 4


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate4) MonthNum,
	   datename(Month, @RptBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate4)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate4) MonthNum,
	   datename(Month, @RptBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate4)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate4) MonthNum,
	   datename(Month, @RptBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate4)
group by aaaaa.lob_id


union all


-- Month 5


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate5) MonthNum,
	   datename(Month, @RptBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate5)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate5) MonthNum,
	   datename(Month, @RptBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate5)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate5) MonthNum,
	   datename(Month, @RptBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate5)
group by aaaaa.lob_id


union all


-- Month 6


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate6) MonthNum,
	   datename(Month, @RptBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate6)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate6) MonthNum,
	   datename(Month, @RptBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate6)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate6) MonthNum,
	   datename(Month, @RptBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate6)
group by aaaaa.lob_id


union all


-- Month 7


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate7) MonthNum,
	   datename(Month, @RptBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate7)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate7) MonthNum,
	   datename(Month, @RptBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate7)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate7) MonthNum,
	   datename(Month, @RptBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate7)
group by aaaaa.lob_id


union all


-- Month 8


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate8) MonthNum,
	   datename(Month, @RptBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate8)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate8) MonthNum,
	   datename(Month, @RptBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate8)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate8) MonthNum,
	   datename(Month, @RptBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate8)
group by aaaaa.lob_id


union all


-- Month 9


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate9) MonthNum,
	   datename(Month, @RptBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate9)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate9) MonthNum,
	   datename(Month, @RptBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate9)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate9) MonthNum,
	   datename(Month, @RptBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate9)
group by aaaaa.lob_id


union all


-- Month 10


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate10) MonthNum,
	   datename(Month, @RptBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate10)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate10) MonthNum,
	   datename(Month, @RptBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate10)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate10) MonthNum,
	   datename(Month, @RptBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate10)
group by aaaaa.lob_id


union all


-- Month 11


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate11) MonthNum,
	   datename(Month, @RptBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate11)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate11) MonthNum,
	   datename(Month, @RptBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate11)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate11) MonthNum,
	   datename(Month, @RptBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate11)
group by aaaaa.lob_id


union all


-- Month 12


select 1 CategoryOrder, @RptYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptBeginDate12) MonthNum,
	   datename(Month, @RptBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate12)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptBeginDate12) MonthNum,
	   datename(Month, @RptBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate12)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptBeginDate12) MonthNum,
	   datename(Month, @RptBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptEndDate12)
group by aaaaa.lob_id

--Prior Year


union all

-- Month 1


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate1) MonthNum,
	   datename(Month, @RptPYBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate1)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate1) MonthNum,
	   datename(Month, @RptPYBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate1)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate1) MonthNum,
	   datename(Month, @RptPYBeginDate1) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate1
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate1)
group by aaaaa.lob_id


union all


-- Month 2


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate2) MonthNum,
	   datename(Month, @RptPYBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate2)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate2) MonthNum,
	   datename(Month, @RptPYBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate2)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate2) MonthNum,
	   datename(Month, @RptPYBeginDate2) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate2
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate2)
group by aaaaa.lob_id


union all


-- Month 3


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate3) MonthNum,
	   datename(Month, @RptPYBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate3)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate3) MonthNum,
	   datename(Month, @RptPYBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate3)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate3) MonthNum,
	   datename(Month, @RptPYBeginDate3) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate3
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate3)
group by aaaaa.lob_id


union all


-- Month 4


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate4) MonthNum,
	   datename(Month, @RptPYBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate4)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate4) MonthNum,
	   datename(Month, @RptPYBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate4)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate4) MonthNum,
	   datename(Month, @RptPYBeginDate4) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate4
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate4)
group by aaaaa.lob_id


union all


-- Month 5


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate5) MonthNum,
	   datename(Month, @RptPYBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate5)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate5) MonthNum,
	   datename(Month, @RptPYBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate5)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate5) MonthNum,
	   datename(Month, @RptPYBeginDate5) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate5
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate5)
group by aaaaa.lob_id


union all


-- Month 6


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate6) MonthNum,
	   datename(Month, @RptPYBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate6)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate6) MonthNum,
	   datename(Month, @RptPYBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate6)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate6) MonthNum,
	   datename(Month, @RptPYBeginDate6) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate6
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate6)
group by aaaaa.lob_id


union all


-- Month 7


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate7) MonthNum,
	   datename(Month, @RptPYBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate7)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate7) MonthNum,
	   datename(Month, @RptPYBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate7)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate7) MonthNum,
	   datename(Month, @RptPYBeginDate7) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate7
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate7)
group by aaaaa.lob_id


union all


-- Month 8


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate8) MonthNum,
	   datename(Month, @RptPYBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate8)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate8) MonthNum,
	   datename(Month, @RptPYBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate8)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate8) MonthNum,
	   datename(Month, @RptPYBeginDate8) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate8
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate8)
group by aaaaa.lob_id


union all


-- Month 9


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate9) MonthNum,
	   datename(Month, @RptPYBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate9)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate9) MonthNum,
	   datename(Month, @RptPYBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate9)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate9) MonthNum,
	   datename(Month, @RptPYBeginDate9) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate9
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate9)
group by aaaaa.lob_id


union all


-- Month 10


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate10) MonthNum,
	   datename(Month, @RptPYBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate10)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate10) MonthNum,
	   datename(Month, @RptPYBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate10)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate10) MonthNum,
	   datename(Month, @RptPYBeginDate10) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate10
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate10)
group by aaaaa.lob_id


union all


-- Month 11


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate11) MonthNum,
	   datename(Month, @RptPYBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate11)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate11) MonthNum,
	   datename(Month, @RptPYBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate11)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate11) MonthNum,
	   datename(Month, @RptPYBeginDate11) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate11
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate11)
group by aaaaa.lob_id


union all


-- Month 12


select 1 CategoryOrder, @RptPYYear RptYear, 
       'Indemnity Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate12) MonthNum,
	   datename(Month, @RptPYBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'I'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate12)
group by aaaaa.lob_id

union all

select 2 CategoryOrder, @RptPYYear RptYear, 
       'Expense Payments' CategoryType,
	   datepart(mm, @RptPYBeginDate12) MonthNum,
	   datename(Month, @RptPYBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Paid Loss' and aaaaa.IndExp = 'E'
					   then aaaaa.Amount
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and e.reserve_or_paid_code = 'P'
/*  MH  6/14/2022 - To fix Paid Reimbursements
  and e.transaction_indicator &lt;&gt; 'R' */
  and (e.transaction_indicator &lt;&gt; 'R' or e.recovery_type = '4')
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate12)
group by aaaaa.lob_id

union all

select 3 CategoryOrder, @RptPYYear RptYear, 
       'Recoveries' CategoryType,
	   datepart(mm, @RptPYBeginDate12) MonthNum,
	   datename(Month, @RptPYBeginDate12) Month, aaaaa.lob_id,
	   IsNull(sum(case when aaaaa.MainTransType = 'Recovery'
					   then aaaaa.Amount * -1
					   end), 0) Amount
from (
select a.claim_id,
       a.fh_claim_num claim_num,
	   a.lob_id,
	   e.reserve_date,
	   e.transaction_indicator,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
	        when e.recovery_type is not NULL or e.reserve_description like '%Recovery%'
			then 'Recovery'
			when e.reserve_or_paid_code = 'R'
	        then 'Reserve'
			end MainTransType,
	   case when e.reserve_or_paid_code = 'P'
			then 'Paid Loss'
			when e.recovery_type is not NULL
			then (select rt.recovery_type_desc
			      from [dbo].[fv_lookup_pay_recov_type] rt
				  where e.recovery_type = rt.recovery_type_code)
			when e.reserve_or_paid_code = 'R'
	        then e.reserve_description
			end TransType,
	   case when i.item_name = 'Indemnity' then 'I'
	        else 'E' end IndExp,
	   e.loss_amt Amount
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
	 [dbo].[fh_reserve_paid] e, 
	 [dbo].[fh_policy_coverage] pc,
	 [dbo].[fh_reserve_type] h,
	 [dbo].[fh_code_general] i
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = e.claim_id
  and a.policy_id = pc.policy_id
  
												 
												 
  and a.lob_id = pc.lob_id and pc.coverage_id = (select max(pc1.coverage_id) from [dbo].[fh_policy_coverage] pc1 where pc.policy_id = pc1.policy_id and pc.lob_id = pc1.lob_id)
  and e.reserve_type_id = h.reserve_type_id
  and i.item_id = h.reserve_group_id

) aaaaa
where aaaaa.reserve_date &lt; dateadd(d, 1, @AsOfDate) and aaaaa.reserve_date &gt;= @RptPYBeginDate12
  and aaaaa.reserve_date &lt; dateadd(d, 1, @RptPYEndDate12)
group by aaaaa.lob_id



) aaaaaa
where aaaaaa.lob_id in (@LOB)
group by aaaaaa.RptYear,
         aaaaaa.MonthNum,
         aaaaaa.Month,
         aaaaaa.CategoryOrder,
         aaaaaa.CategoryType
--order by 1, 2, 4

end</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="RptYear">
          <DataField>RptYear</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MonthNum">
          <DataField>MonthNum</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Month">
          <DataField>Month</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CategoryOrder">
          <DataField>CategoryOrder</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="CategoryType">
          <DataField>CategoryType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Amount">
          <DataField>Amount</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DataSet2">
      <Query>
        <DataSourceName>SharedLocalDS</DataSourceName>
        <CommandText>select convert(char(4), datepart(yyyy, c.reserve_date)) Year
from [dbo].[fh_claim] a,
     [dbo].[fh_policy] b,
     [dbo].[fh_reserve_paid] c
where a.policy_id = b.policy_id
  and b.tier1_company_id = 'C13339'
  and a.claim_id = c.claim_id
group by datepart(yyyy, c.reserve_date)
order by 1 desc</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="Year">
          <DataField>Year</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DataSet3">
      <Query>
        <DataSourceName>SharedLocalDS</DataSourceName>
        <CommandText>select b.lob_id,
       b.lob_name
from [dbo].[fh_claim] a,
     [dbo].[fh_lob] b,
     [dbo].[fh_policy] c
where a.lob_id = b.lob_id
  and a.policy_id = c.policy_id
  and c.tier1_company_id = 'C13339'
group by b.lob_id,
         b.lob_name
order by 2</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="lob_id">
          <DataField>lob_id</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="lob_name">
          <DataField>lob_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox5">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style>
                                  <FontFamily>Arial</FontFamily>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox5</rd:DefaultName>
                        <Style>
                          <Border>
                            <Style>Solid</Style>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <LeftBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </LeftBorder>
                          <RightBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </RightBorder>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox7">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>Month</Value>
                                <Style>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>#666666</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox7</rd:DefaultName>
                        <Style>
                          <Border>
                            <Style>Solid</Style>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <LeftBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </LeftBorder>
                          <RightBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </RightBorder>
                          <BackgroundColor>White</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Count">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!Amount.Value)</Value>
                                  <Style>
                                    <FontWeight>Normal</FontWeight>
                                    <Format>'$'#,0.00;('$'#,0.00)</Format>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Count</rd:DefaultName>
                          <ActionInfo>
                            <Actions>
                              <Action>
                                <Drillthrough>
                                  <ReportName>=IIf(IsNothing(Sum(Fields!Amount.Value)), Nothing, "/Claims Reports/Claim Payments by Month Detail Report")</ReportName>
                                  <Parameters>
                                    <Parameter Name="RptMonth">
                                      <Value>=Fields!MonthNum.Value</Value>
                                    </Parameter>
                                    <Parameter Name="RptYear">
                                      <Value>=Fields!RptYear.Value</Value>
                                    </Parameter>
                                    <Parameter Name="CategoryType">
                                      <Value>=Fields!CategoryType.Value</Value>
                                    </Parameter>
                                    <Parameter Name="LOB">
                                      <Value>=Parameters!LOB.Value</Value>
                                    </Parameter>
                                    <Parameter Name="AsOfDate">
                                      <Value>=Parameters!AsOfDate.Value</Value>
                                    </Parameter>
                                  </Parameters>
                                </Drillthrough>
                              </Action>
                            </Actions>
                          </ActionInfo>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>White</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox45">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(IIf(Fields!CategoryOrder.Value = 3, Fields!Amount.Value * -1, Fields!Amount.Value))</Value>
                                  <Style>
                                    <FontWeight>Normal</FontWeight>
                                    <Format>'$'#,0.00;('$'#,0.00)</Format>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox45</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontWeight>Normal</FontWeight>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <TopBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </RightBorder>
                            <BackgroundColor>PaleTurquoise</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Count2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!Amount.Value)</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>'$'#,0.00;('$'#,0.00)</Format>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Count</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Khaki</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox46">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(IIf(Fields!CategoryOrder.Value = 3, Fields!Amount.Value * - 1, Fields!Amount.Value))</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>'$'#,0.00;('$'#,0.00)</Format>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox45</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Khaki</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox28">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontWeight>Normal</FontWeight>
                                    <Color>#333333</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox28</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <TopBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>Black</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </RightBorder>
                            <BackgroundColor>PaleTurquoise</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="RptYear">
                    <GroupExpressions>
                      <GroupExpression>=Fields!RptYear.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!RptYear.Value</Value>
                      <Direction>Descending</Direction>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>0.25in</Size>
                    <CellContents>
                      <Textbox Name="RptYear">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!RptYear.Value</Value>
                                <Style>
                                  <FontWeight>Normal</FontWeight>
                                  <Color>#333333</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>RptYear</rd:DefaultName>
                        <Style>
                          <Border>
                            <Style>Solid</Style>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <LeftBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </LeftBorder>
                          <RightBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </RightBorder>
                          <BackgroundColor>White</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="CategoryOrder">
                        <GroupExpressions>
                          <GroupExpression>=Fields!CategoryOrder.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!CategoryOrder.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember>
                          <Group Name="CategoryType">
                            <GroupExpressions>
                              <GroupExpression>=Fields!CategoryType.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!CategoryType.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixHeader>
                            <Size>0.25in</Size>
                            <CellContents>
                              <Textbox Name="CategoryType">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>=Fields!CategoryType.Value</Value>
                                        <Style>
                                          <FontWeight>Normal</FontWeight>
                                          <Color>#333333</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style>
                                      <TextAlign>Center</TextAlign>
                                    </Style>
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>CategoryType</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Style>Solid</Style>
                                  </Border>
                                  <TopBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </TopBorder>
                                  <BottomBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </BottomBorder>
                                  <LeftBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </LeftBorder>
                                  <RightBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </RightBorder>
                                  <BackgroundColor>White</BackgroundColor>
                                  <VerticalAlign>Middle</VerticalAlign>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>0.25in</Size>
                        <CellContents>
                          <Textbox Name="Textbox44">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value> Net Payments</Value>
                                    <Style>
                                      <FontWeight>Normal</FontWeight>
                                      <Color>#333333</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox44</rd:DefaultName>
                            <Style>
                              <Border>
                                <Style>Solid</Style>
                              </Border>
                              <TopBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </TopBorder>
                              <BottomBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </BottomBorder>
                              <LeftBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </LeftBorder>
                              <RightBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </RightBorder>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>0.25in</Size>
                        <CellContents>
                          <Textbox Name="Textbox2">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value />
                                    <Style>
                                      <FontWeight>Normal</FontWeight>
                                      <Color>#333333</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox2</rd:DefaultName>
                            <Style>
                              <Border>
                                <Style>Solid</Style>
                              </Border>
                              <TopBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </TopBorder>
                              <BottomBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </BottomBorder>
                              <LeftBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </LeftBorder>
                              <RightBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </RightBorder>
                              <BackgroundColor>PaleTurquoise</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Group1">
                    <GroupExpressions>
                      <GroupExpression>Report</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>Report</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="MonthNum">
                        <GroupExpressions>
                          <GroupExpression>=Fields!MonthNum.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!MonthNum.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember>
                          <Group Name="Month">
                            <GroupExpressions>
                              <GroupExpression>=Fields!Month.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!Month.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixHeader>
                            <Size>0.82292in</Size>
                            <CellContents>
                              <Textbox Name="Month">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>=Fields!Month.Value</Value>
                                        <Style>
                                          <FontWeight>Normal</FontWeight>
                                          <Color>#333333</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style />
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>Month</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Style>Solid</Style>
                                  </Border>
                                  <TopBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </TopBorder>
                                  <BottomBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </BottomBorder>
                                  <LeftBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </LeftBorder>
                                  <RightBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </RightBorder>
                                  <BackgroundColor>White</BackgroundColor>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>0.82292in</Size>
                        <CellContents>
                          <Textbox Name="Textbox25">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Totals:</Value>
                                    <Style>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#333333</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Right</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox25</rd:DefaultName>
                            <Style>
                              <Border>
                                <Style>Solid</Style>
                              </Border>
                              <TopBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </TopBorder>
                              <BottomBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </BottomBorder>
                              <LeftBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </LeftBorder>
                              <RightBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </RightBorder>
                              <BackgroundColor>Khaki</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <KeepWithGroup>Before</KeepWithGroup>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet1</DataSetName>
            <SortExpressions>
              <SortExpression>
                <Value>=Fields!RptYear.Value</Value>
                <Direction>Descending</Direction>
              </SortExpression>
              <SortExpression>
                <Value>=Fields!MonthNum.Value</Value>
              </SortExpression>
            </SortExpressions>
            <Top>2.875in</Top>
            <Left>0.125in</Left>
            <Height>1in</Height>
            <Width>3.82292in</Width>
            <Style>
              <Border>
                <Style>Solid</Style>
              </Border>
              <TopBorder>
                <Color>Black</Color>
                <Style>Solid</Style>
                <Width>1pt</Width>
              </TopBorder>
              <BottomBorder>
                <Color>Black</Color>
                <Style>Solid</Style>
                <Width>1pt</Width>
              </BottomBorder>
              <LeftBorder>
                <Color>Black</Color>
                <Style>Solid</Style>
                <Width>1pt</Width>
              </LeftBorder>
              <RightBorder>
                <Color>Black</Color>
                <Style>Solid</Style>
                <Width>1pt</Width>
              </RightBorder>
            </Style>
          </Tablix>
          <Textbox Name="ReportTitle">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>="Claim Payments Report for: " + Parameters!RptYear.Value</Value>
                    <Style>
                      <FontFamily>Segoe UI Light</FontFamily>
                      <FontSize>28pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>1.25in</Top>
            <Left>0.125in</Left>
            <Height>0.5in</Height>
            <Width>7in</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Image Name="Image1">
            <Source>Embedded</Source>
            <Value>GramercyLogo</Value>
            <Sizing>FitProportional</Sizing>
            <Top>0.20708in</Top>
            <Left>0.11333in</Left>
            <Height>0.97347in</Height>
            <Width>1.65625in</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Image>
          <Textbox Name="ReportTitle3">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>="For LOB(s): " + IIF(COUNTROWS("DataSet3").Equals(Parameters!LOB.Count),"All LOBs",Join(Parameters!LOB.Label, ","))</Value>
                    <Style>
                      <FontFamily>Segoe UI Light</FontFamily>
                      <FontSize>14pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>1.81944in</Top>
            <Left>0.125in</Left>
            <Height>0.27778in</Height>
            <Width>7in</Width>
            <ZIndex>3</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="ReportTitle4">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>="Report Run on: " + Globals!ExecutionTime</Value>
                    <Style>
                      <FontFamily>Segoe UI Light</FontFamily>
                      <FontSize>14pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>2.15278in</Top>
            <Left>0.11333in</Left>
            <Height>0.27778in</Height>
            <Width>4.20833in</Width>
            <ZIndex>4</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="ReportTitle5">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>="As of: " + Parameters!AsOfDate.Value</Value>
                    <Style>
                      <FontFamily>Segoe UI Light</FontFamily>
                      <FontSize>14pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>2.5in</Top>
            <Left>0.125in</Left>
            <Height>0.27778in</Height>
            <Width>4.20833in</Width>
            <ZIndex>5</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>3.875in</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>11.19444in</Width>
      <Page>
        <PageFooter>
          <Height>0.45in</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <LeftMargin>1in</LeftMargin>
        <RightMargin>1in</RightMargin>
        <TopMargin>1in</TopMargin>
        <BottomMargin>1in</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="RptYear">
      <DataType>String</DataType>
      <Prompt>Report Year</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet2</DataSetName>
          <ValueField>Year</ValueField>
          <LabelField>Year</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="LOB">
      <DataType>String</DataType>
      <Prompt>LOB</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet3</DataSetName>
          <ValueField>lob_id</ValueField>
          <LabelField>lob_name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="AsOfDate">
      <DataType>DateTime</DataType>
      <Prompt>As Of Date</Prompt>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>4</NumberOfColumns>
      <NumberOfRows>3</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>RptYear</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>LOB</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>2</RowIndex>
          <ParameterName>AsOfDate</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <EmbeddedImages>
    <EmbeddedImage Name="GramercyLogo">
      <MIMEType>image/jpeg</MIMEType>
      <ImageData>/9j/4AAQSkZJRgABAQEAeAB4AAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCABnANIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9U6KKKACiiigAooooAKKKKACiiigBtYnizxlongTRJtX8Qapa6RpsP+surp9iCrOua5Z+G9JvNU1CVbeytInmmmboqLya/BX9r79qrxT+1x8XH03TZbhfDEd59j0XRoJPll+bYJG/vu9YTnf3Ylxjc/Rjxh/wVS8F/wDCSN4f
+HnhXW/iJqm7YP7Nh+R/pWj/AMNyfFHQ9Pj1TxH+zp4osdH++89pIk0iJ/uV6L+xl+yj4c/Zr+GGmwRWUUniu8gWXVNSZcyO7AfIP9kelfRm2uZRqSjzKRXu9j5i0L/gol8Gtc8A6t4k/t17CbS0zc6Pfx+Teq/9zZX0R4Z8Q23irw/p2r2isttfW6XMW/rtcZFfmz/wVW/ZF05dBi+L3hXTVtr21lVNahto8LKh6TfUcCvvr9n66+3fBPwPc/8APTR7Y/8Ajgp05VFUUZMiXwnotFFFd5IUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAfK3/AAUs8ZXPgv8AZF8YyWr7J78R2W7/AGXfmvyr/wCCavgq28dftceEYryLzoLDztQ29tyJlf1r9N/+Cq2izap+yLrssSs/2S7gmfZ/c38/0r85P+CVfiKHQf2v9BW4ZVW+s7q1Td/fdOK4XtM2ifu9R+FI3zLXm3jbS/iHb7rjwxrdncp2tL63Uf8Aj9aV6rpQ51HmIjHmOp8deDdM+IXg/V/DGsJ5+mapbPa3MfqjCm+A/B9j8PfBukeG9NeRrDS7ZLaHzmy2xBgZr5b1v9pH4geG/EM2gapc6da61CnmNZPEm/y/79dR8Kfjx4u8WfEDTNI1KS1+xXAfeiQ7H4r5mOeYOWIjDklz/Cdf1WfJc+oqKSlr7A4QooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA5D4ofD7Tvin8Ptd8J6onmWOq2j20g+o/wAa/n58beCvGP7Gv7QEcE8UlprGg3y3djOR8lxCH+Rx9a/o0615H8f/ANmH4f8A7SWgjTvGOjrcTxf8e+oQfJcwf7j1zzhb3olxkXP2evjdov7QHws0XxdolzHMLmFPtNujZe2m/jR69O+tfnP4X/4J3/Fv9nfxDdaj8FPipHaWVw2X0/VIPkk/3+1eg6r4B/bM8YaW
+j3fjnwj4bhlTY+o6ba/vx/uelc6rSjHkUSuU+AP+Cm3xLtvEH7XGp3Ph3UGDaRbQ2L3Nq+zEyD5/nFfot+wP4JsvF3wJ+H/AI91CW4m8R+Q/nXW/wD13+/XN/BP/glb8PPA2rHXPHN5N8QtdkfzW+2jbBv67tn8f419jeC/BGifD3QbfRPD9hHpulQf6q1hGET6VgsLTrSgqkPgK5+X4ToKWiivXMAooooAKKKKACiiigAooooAKKKKACvDvjB+118P/g34jtfDOoX1zrPi28/49vD+jQ/arp/Yon3P+B1m/twftCH9m/8AZ/13xJaHOt3H+gaaM/8ALZ+A/wDwDrXjv/BMn4BL4f8AhePip4qj/tfx94ud73+077554YOiLv8A9v7/AONAHtDfH74iSWYv4Pgf4gey27/Lkv7VJ9v+5vrA8P8A/BQL4WXN5Lo+vz6j4P8AFEM0Ns+gaxZul0Xd9ibOPnr6cr5X/bS/ZRi+OVn4X8R6Bpdu/jvw9rFncwXRwjzWyTIZI3f0/j/CgD6ljbzFzT6+YP26tT8deA/gvqvj7wX41u/Dl7oNr5z2McKPDc/7++uf+DXgj4p/GL9nvwj4wX4163pviXW9OTUH/wBDtntUdx9zZs+5QB9f0yvjz9lj9qTxvrHxq8V/BH4sW1j/AMJroK+ba6ppy+XHqEI/j2dvkO+vsagAor87v25P2lfiJ4B+KGiat4V1Z7b4aeFtas7LxH9k++07/vCj/wCxsr9ANF1a31rSbHUrVt9reQpcQv8A7DrvFAF6n18tftgaV8SvC3hq/wDFvgX4j32jXzy2tnZ6JJawva73fZ12b/46xP2Af2jPE/xQ07xf4E+Itz53xE8H372148ibHmh34D0AfXtPrP1TVLbRdNur67fyrW3ieaWRv4VQZNfm5pHxz+NvxS/bIsfAJ8eyeEvCHiC2fV9Oj0+2heaGy8vfDnen33oA/TCivAv2pNH8aaR8HdQ8Q+FPHmoe
HdT8N6XNdNshjdL90j/5bb09q8j/AGQP+Fn/ALSXwF0XxxrHxd1vTdSu5pkeGxtbby/kf/coA+3KK+N45vjd8BP2hPCKeKPGF58QvhX4gkfTGuPsSJNp9y/+p87Z/B/t1h/8FEPHHxN+BOk6J4y8E/EK702y1HUYdLfR5LaGSFN/8afJQB9yUV8yeJPgv8Ym8J2uqeDPjPqb+IFt0mW01yzgeyuH2fc+RN6VF+xL+1beftGaL4h0jxJpqaT468L3P2PV4IP9S5yV3p+KGgD6dp9fLHxR/aO8SeNPjPN8Ffg+1kPFVnF9p13xFqKb7XSIs42In8c3PSumuP2b/F8lj9oj+NfjCPxDs/4+v3Pkb/8Arj5eNtAHv1Pr45+HPj74zat8VvEvwY+ImqWei6qmj/bdF8VaBBj7Ygkx52x/4/76V4lB8Tvjd8Lf2wtC+FnxR+Kl3F4Z1R/M0rWLSyhT7fz+7R/k9fkegD9MKfXBfGjWbfw38LfEmp3Wv3Hhe1s7N5n1i1RXktgO6L3rw/8AZF8L/GTXtFsPGnxL8f6jPDeB5bPw89tCmLY/ceb5Pv0AfVtFFFAH5/f8FltEur39nHQbyAM0FjryNN/wONwK+l/2NtetPEf7MHw2vbF0eH+x4YMp/fT5H/Va6r44fCfS/jh8LfEXgrV1AtdVt2hWTvFJ/A/4NXwr+yn8XNV/YP1i5+C/xrt7jTPD8l402h+KtrvYbX/g3/wDOfp/MA/SS4Zo4XZV8x1X7n96vjb4p/8ABR2H4K+I7PRPGXwo8WaVeX77bDf5P+l/Ps+T56+nrP4u+CL7TUv7fxfoc9mw3C4j1CHZ/wCh1+af/BQjx9pXx6/aK+EmhfDiZvGt9od2k182hp9qSH9+j43p7UAfS/7WvjnVPiJ+wn8RtY1fwnqXgy7ezYJpurFPP2fJ8/yV5z8Mv24tG/Z1/ZH+GH9seB/FMqf2PBa2199mRLGZwnUTF/uV69/wUQ8S6bpf7IHj
Wwv9RtLXULzTkjhtppkR5X44RKd+yzpvgv41fsV+B/BWq3Wna1bXPhuG1vLESo7wnZ3T+B0/pQBzn7JP7OPin/hcniP4/wDxC1TS77XPFVv/AMS2y0qTfDZ2z/c+f+P5NiV9UfEbxja/D/wPrniO8lWC0020e5eR+2K+AP2TvjVffsffGPXf2efipqj2uhR3Pn+FdWvW/c+S/wByPeeNh/8AQ817V+1B8WPC3xF8Y/Dr4SWviXTBpuvX/wDaGtzx3ybPsFt8/kn/AK6Ps/74oA8i1LXPhb4w/Yx8XeGda8W2134x8Tw3PiC8/wBDm8z+0H/fIn3P4OEr1/8A4Ji/Fuf4qfst6JBqDNJqfhyZ9ImeRvmbZyh/74YV9OQeG/D8lvHLFpenPBs3JIlsmzbX5u/s9fErwx+y/wDt8fEjwC2v6fH4I8Vub2zmjuE8i2ufv7D/AHX5dKAPtL9rdv8Ai1dr/wBhiw/9HpXyj+0FCf2Sf2+PCPxcG+Lwj44/4lmsBPkRJ8BN7/8Ajj17P+258avCGj/DbQIR4i02Se98Q6eESC5R32edv3/7nFbH7bfws0/9pj9l/wAS2egXtpqV9Yp/adhdWbpMPOhG/Yjp/f6fjQB1H7QkzfEGTwt8M9NvPK/4SWf7TqMkLjf/AGbF882P9/KD8a+Z9SsrfTf+CuHh6ytYkhtbbwtshhQfIieTXp/7Amg+INS+EWm/E74iXCNr9/p0djbSXHyC2sIC6J9/7jv/AB/SvEPEXxC8M/8AD23RNT/4SDT/AOzP7A8h737Snk+Z5D/JvoA+3f2nv+Te/iH/ANgS5/8AQK+L/wBijx58RPC/7C8B8LeCf7aSGHUHhukvAj78v/BX1v8AtSeMNCsf2efG5u9a0+BLzRLn7P5lyn7793/B/fr5+/4Ja/E/whH+yfpeh3fiDTLbUbO8uVubK6uUjdN75HyOelAHv37IGuah4q/Zu8Dalrd1NqWp3Fn5lzPdfO5k3mvA
f+CuT+T8BPCr7Wfb4ntTsT6PXqXxq/ay8G/CdfD/AIQ8E3Ola7418QX8NhpWjadIjxws7/66bZ9xK8R/4KzeKtNj+Dfg7SbvVLIa2niCzmubZJvnQBDvfZ/c/wAaAOv+I37fSeCYdA8FaV4H1zSfGmt28dvpU3ieFLPTt7p8jvNvrrv2Kf2V9R/Zx8P+Kta8T6nb6z448VXL6hqM1r/qU6vsT/gbmug+M/wf8Kftefs8zeHbbUbK9n+yRTadqlq6SfZblU+Q7x+P514v+wn+1wttZ3vwV+Kt+mi+P/CLPZpNqM2z7dEnHLufv/0xQBz/APwS21JfEnxH+P8Arepqv/CR3OvJv8z7/l/vK/RGvy68Y22v/wDBPT9rfXPigNLuNc+EvjSR/tk1im82m+Tf/wCOfrX3b4d/ai+E/i7w/DrNh8QvD4sJU35m1GKN0/30Y5T8aAPQJvDml3muWusy2MUmq2sTww3Tr86I/wB9BXzz+3h+zbD8evhHPfaURZeN/DWdS0fUI/vq6fOY/wDgf867TwX8ek+L3jZbPwJajVvC1gx/tTxJcK6Wzt/DDbf336fN0ru/ib4k0rwz4J1q41bUbXTYXs5kSS6lVAzeW/HNAHyF+zR468RftyeGfCV/4lt207wt4QlCa1bMc/21qUWNgb/pkn38er190pGI1Cr92vz8/wCCR3jLRW+EfizSX1azTU5vE9zJDavOgmdGRMbUr9BqACiiigArI1zw3pXiSya01fTLTVrXvBewpMn5PWvRQB4637JHwea4+0t4A0nzcfdjV1j/AO+N239K7rw/4D8OeA7F49A8O2GnJGnyR2NsiO344rqKSgD52174reD/ABfNe3eu/DbU9Wj0R/Ju5rvTUnNp/wAAr0/wHo/gWx0+213wvp2mabBqMO9Li1jSHelfPHiHVPFmjwfFi50D7O+mf2xs1Hy033KQunzulbnjTwv4ZPg34PR6XnUdP/tWC2Sbf880bku6Ofd6
8KnjZ/b/AK943lE958TeCfCPi68h/tzSNJ1W9RP3X22FJH2+2e1ZK/B/4c+W0n/CMaFhP+WnkJ8v/Aq8Q1jS4vC3jwaxrNmmv6HdeIES28S2Nz/pVg+/Ylq6f3P4K5/T7Wx/4WJ4o8K6vA+leCtS8Qv519G/yTTJ86Wrv/Anz12fXIC5D6e8deMLX4d+E/7Q/sm71LTIVw8enIH8qHZ9/H92uM+HHhn4VfFbwvD4h0nwhpUkNy2XF1YR+cr/AO3XYfEqCDS/hhrENskcFtDabFT+BFrwWHVbv4UeLLrwhpO6ODxlZwz6PtT5La5dNj06tedKrH+UmMeY6zw5dfCrxp4/1DwzpngO21GTTXaC51JtPje1hKf7Zr2fQ9A0XwzZtpuj2VrY2yjd9lt14H/Aa8c+FGj6f4J+LvjHSrd1hsdN0u1LO3f5Mu71y3gfxTdw/HaDxXcW2p2mj+KXm0/zr7/j1+T/AFHk/wC/WNPET5Oaf83/ALcXKOp9LPaaddabLZlIJLDZsaFcbNn4VyS/Bn4czQmRfCmgyR/89Bap/wCh14jHaX3w38WePfFmlxTaj4cXVHs9X8Pr91Idn+uSrbXVsnwG07QvCtnd3Ufii7mhhOnf677Nv3u6f8ArrjiOb3TPlPedU+HPhPxBZ2UOoaFp9/a2abLdJ4VdEX2rJt/hP8OLhn+y+GdB3r9/7JbIn/oFeCR+ONRvvhL4X8NXd1eaLDDrqaDrE0kmy5hh/g3v/BvSu+8UeHfBHgH4keCbWysL3TNTvHkjhTTY/wBzeps2Ok/4YqI4rmDlPQtK+Gfw/wBJ1eDULDw/ocOpp/qrqOCPzv8AvvrVvVvht4K8VajNf6hoGk6ret8rzzwJK/45r5k+H/gyG88T69Zy+HoYfD9trt0W8SR3ISfTtnzon+5W3HqSfBH4n6t4qtWkbwjq14+m3Nuj70S62J5Lp/v1EcV7vMPlPpDw/wCH/Dvgu3ltNItLHSYmbe8MG1Of
pWPq3w98BeIdQl1K/wBC0S+1F/me6kgiab/vvr+tfPWi+E572f4xXnipHu9bk05Lz52/4898G9IU/wBytP4Q+DLPUdAsrvX/AAzb6JD/AGXst7qO5D/2tvj+ff8A7dOOI55cvKLlPpa/s9MvtP8As19Daz2D/J5NwqPG34HivMf+GcPgs+rvqX/CE+Gft27e7rAmc/7vSvCLqW+8E/B+20TxJJNq3hjWYobjSNRkHz2Fz52fJeuu8dfB7wz4WvPhlBBp5nbUdYH2uSd3d5t8f3H/ANip+te7zcocp9M6NZ6ZY2Kw6VDawWS/djslVI1/74qv4k8J6N4ttY7XWdNt9SgR96R3Sb1DetUfAngLTfh9ptxp2kb0sZrh7pIJH3CHfj5E9ErqD2r0Y7EHH6T8K/Bmi6jDqGmeGNK0++h+5Na2qRun/fNdjRRTAKKKKACiiigAqCe3W6t3hflHXa1FFAHCeE/gx4U8I6hc3+k2MsUl6jrcb7h5EmDdd6seayR+zZ4AiZHTSp41hm8+GNb2YRwyf3kXfxRRWf1el/KaXZp2/wADvB1rrsepR6a63Ky/a/s/2h/Jkl/56NHnaW96ik+APgttH1fTZtLaSy1a5W6u45Lh23zf3uvWiio9nHsZmhrHwj8O+IfDNj4cv4bifTrPlYvtT5P++2ct+NXdE+HugaNHpEdtaeYdKR0s3mdpJIt/38MxoorT2cewHMTfs6eCLi4ubl9PujPc7vPkF/PumQ/wMd/IrW1L4M+FdW8NaT4eurKR9O0tt9pD9ofKf8C60UUexp9h3Ze8J/DPQPCEmqSabbSLJqRzd+dM83mfXeaq6f8ACHwxpevadqlpYNa3enI623l3D7ED9f3edtFFHs49hFeH4H+Dba+1u+k0vzzrH/H+k8rvHL9VzSaD8EvC+g6lHqNvb3Vxdxo6QPdXbzmFX67N5+X8KKKz9nHsBQX9nPwRFDPEun3Qtrh/Pnh+3z+XM3rIu/5q1vD/
AMHPCnh9bqK003zI7mZLl4rqZ508xPuNhyeaKKPZx7FXZUuvgP4QvtQ1i7ls7o3Gqf8AH4/22b97/wCP1Db/ALP3grTxBHHYTiOJHhgjkvJmWLf18v5/looo9nEOZm5H8M/Dcfg+LwnJYifRU4S0mdmwc7vvZzUXjD4T+HPGlzpdzrFrLNJpp/0TZcPH5f8A3yaKK09nHsSdlHGIURB91RUlFFWAUUUUAFFFFAH/2Q==</ImageData>
    </EmbeddedImage>
  </EmbeddedImages>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportServerUrl>http://gramercymga/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>3dc19f5a-0946-476f-979c-4b097bf0e86c</rd:ReportID>
</Report>